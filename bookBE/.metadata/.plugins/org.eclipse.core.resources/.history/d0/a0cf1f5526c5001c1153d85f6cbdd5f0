<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="book">
<!-- 책 리스트 불러오기 -->
	<select id="findAll" resultType="book">
		<![CDATA[
			select * from book;
		]]>
	</select>
	
	<!-- 책 제목으로 책 리스트 불러오기 + 검색포함 -->
	<select id="findByTitle" parameterType = "String" resultType="book">
		<![CDATA[
			select * from book where title like #{title};
		]]>
	</select>
	<!-- 책 no로 책 하나 불러오기-->
	<select id="findByNo" parameterType = "int" resultType="book">
		<![CDATA[
			select * from book where no = #{no};
		]]>
	</select>
	<!-- 책 대여시 use에 카운트 +1 -->
	<update id="update" parameterType="int">
	<![CDATA[
			update book set usebook = (usebook + 1) where no = #{no}
		]]>
	</update>
	<!-- 관리자가 도서 삭제 -->
	<delete id="deletebook" parameterType ="int">
		<![CDATA[
			delete from book where no = #{no} 
			]]>
	</delete>
	<!-- 관리자가 도서 등록 -->
	<insert id="insert" parameterType ="book">
		<![CDATA[
			insert into book values(null, #{title}, #{writer}, #{contents}, #{price}, now(), 0, #{img})
		]]>
	</insert>
	<!-- 책 정보 수정 -->
	<update id="updateBook" parameterType="book">
	<![CDATA[
			update book set title=#{title},
							writer=#{writer},
							contents=#{contents},
							price=#{price},
							img=#{img}
							where no = #{no}
		]]>
	</update>
	<!-- 책 리스트 대여순으로 불러오기 -->
	<select id="findRank" resultType="book">
		<![CDATA[
			select * from book
			order by usebook desc
			limit 5
		]]>
	</select>
</mapper>