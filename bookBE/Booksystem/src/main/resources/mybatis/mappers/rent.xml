<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="rent">
<!-- 책 대여하기 -->
	<insert id="insert" parameterType ="rent">
		<![CDATA[
			insert into rent values(#{book_no}, #{user_no}, #{user_id}, now(), date_add(now(), interval 14 day))
		]]>
	</insert>
	<!-- 대여 권수 최대 3권 위해 대여 책 개수 받기 -->
	<select id="findByNo" parameterType="int" resultType="int">
	<![CDATA[
		select count(*) from rent where user_no = #{user_no}
	]]>
	</select>
	<!-- 사용자가 대여중인 책 조회 // 반납 날짜 빠른순 정렬-->
	<select id="findByUserNo" parameterType ="int" resultType="rentDto">
		<![CDATA[
			select * from book as a
			inner join rent as b
			on a.no = b.book_no
			where b.user_no = #{user_no}
			order by b.return_date asc  
		]]>
	</select>
	<!-- 대여 도서 반납(삭제) -->
	<delete id="delete" parameterType ="int">
		<![CDATA[
				 delete from rent where book_no = #{book_no} 
			]]>
	</delete>
</mapper>